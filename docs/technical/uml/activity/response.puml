@startuml
'https://plantuml.com/class-diagram

!include ../user.puml
!include ../activity-metamodel.puml

package activity.response {
    class ResponseActivitySession extends activity.metamodel.ActivitySession {
        learner: Learner
        activityConfig: ResponseActivityConfig
        material: Question
        output: Response

        submitResponse(response: Response)
    }

    class ChangeResponseActivitySession extends ResponseActivitySession {
        previousResponse: Response
        modifyResponse()
    }

    ResponseActivitySession --> Learner
    ResponseActivitySession --> Response
    ResponseActivitySession --> ResponseActivityConfig

    class ResponseActivityConfig implements activity.metamodel.ActivityConfig {
        provideConfidenceDegree: boolean
        provideExplanation: boolean
    }

    abstract class Question implements activity.metamodel.Material {
        statement: Content
        explanatoryFeedback: String
    }

    class OpenQuestion extends Question

    class ClosedQuestion extends Question {
        choices: List<Choice>
    }


    abstract class Response implements activity.metamodel.LearnerOutput {
        question: Question
        confidenceDegree
    }

    class OpenResponse extends Response {
        answer: Content
    }

    abstract class CloseResponse extends Response {
        explanation: Content
    }

    class SingleChoiceResponse extends CloseResponse {
        selectedChoice: Choice
    }

    class MultipleChoiceResponse extends CloseResponse {
        selectedChoices: List<Choice>
    }

    Response "*" --* "1" Question
    Response "*" --* "1" Learner

    class ResponseGradeTransformer implements activity.metamodel.MaterialTransformer {
        transform(response: Response): scenario.Grade
    }

    class ResponseCorrectnessTransformer implements activity.metamodel.MaterialTransformer {
        transform(response: Response): Correctness
    }

    enum Correctness {
      INCORRECT,
      CORRECT,
      PARTIAL,
      NEUTRAL,
    }
}
@enduml
